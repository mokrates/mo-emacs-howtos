<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2026-02-21 Sa 21:11 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>mos emacs howtos</title>
<meta name="author" content="mokrates" />
<meta name="generator" content="Org Mode" />
<style>
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { }
</style>
</head>
<body>
<div id="content" class="content">
<h1 class="title">mos emacs howtos</h1>
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#orgabf6bf0">1. Moved to codeberg!</a></li>
<li><a href="#org9f23771">2. mo-emacs-config</a>
<ul>
<li><a href="#org542cfae">2.1. keyboard layout</a>
<ul>
<li><a href="#org09d9837">2.1.1. debian</a></li>
<li><a href="#org9291db2">2.1.2. other distros</a></li>
</ul>
</li>
<li><a href="#org0a6aefc">2.2. Keybindings/Prefix keys</a>
<ul>
<li><a href="#orga54f546">2.2.1. Some of the bindings</a></li>
</ul>
</li>
<li><a href="#orga509a6c">2.3. recent-files</a></li>
<li><a href="#orgf226f22">2.4. emacs server</a>
<ul>
<li><a href="#org8a638de">2.4.1. Troubleshooting</a></li>
</ul>
</li>
<li><a href="#org610107d">2.5. my multiple cursors shortcuts</a></li>
<li><a href="#orgd2aeafd">2.6. flymake</a>
<ul>
<li><a href="#org285854e">2.6.1. json (new version)</a></li>
<li><a href="#org93a1736">2.6.2. toml</a></li>
<li><a href="#org8d00306">2.6.3. yaml</a></li>
<li><a href="#org4b34e76">2.6.4. python</a></li>
</ul>
</li>
<li><a href="#org6cb0b8a">2.7. ide stuff, languages</a>
<ul>
<li><a href="#orgf416613">2.7.1. python</a></li>
<li><a href="#org4a41c47">2.7.2. Golang</a></li>
</ul>
</li>
<li><a href="#org69954ab">2.8. show git branch in modeline</a></li>
<li><a href="#orga6cf925">2.9. <span class="todo TODO">TODO</span> ement.el (matrix client)</a></li>
<li><a href="#orgfe281f5">2.10. Random stuff</a>
<ul>
<li><a href="#org0f2f4cd">2.10.1. <code>align-regexp</code> shouldn't use tabs</a></li>
</ul>
</li>
<li><a href="#orgbaa07bf">2.11. misc troubleshooting</a></li>
</ul>
</li>
<li><a href="#org2454d10">3. HOWTOs</a>
<ul>
<li><a href="#org7e4f8be">3.1. Fonts</a>
<ul>
<li><a href="#orgd5c9ba2">3.1.1. default font</a></li>
<li><a href="#org8889f35">3.1.2. how to let emacs find a font for you</a></li>
<li><a href="#org6d14a03">3.1.3. troubleshooting</a></li>
</ul>
</li>
<li><a href="#org2d7a949">3.2. How to build an input method</a></li>
<li><a href="#orge124e02">3.3. Tramp-Methods</a></li>
<li><a href="#org6d04833">3.4. Ansi-Term</a>
<ul>
<li><a href="#org32ba702">3.4.1. pasting</a></li>
<li><a href="#org0913787">3.4.2. tmacs</a></li>
<li><a href="#org96297cb">3.4.3. emacsclient</a></li>
<li><a href="#org77110ef">3.4.4. Forbid TRAMP to ask for password</a></li>
<li><a href="#org731fe56">3.4.5. troubleshooting</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-orgabf6bf0" class="outline-2">
<h2 id="orgabf6bf0"><span class="section-number-2">1.</span> Moved to codeberg!</h2>
<div class="outline-text-2" id="text-1">
<p>
this is archived and old. Please go to mokrates.codeberg.page/mo-emacs-howtos
</p>
</div>
</div>

<div id="outline-container-org9f23771" class="outline-2">
<h2 id="org9f23771"><span class="section-number-2">2.</span> mo-emacs-config</h2>
<div class="outline-text-2" id="text-2">
<p>
Ok, so this is my emacs config wiki
</p>
</div>

<div id="outline-container-org542cfae" class="outline-3">
<h3 id="org542cfae"><span class="section-number-3">2.1.</span> keyboard layout</h3>
<div class="outline-text-3" id="text-2-1">
<p>
Ok, you need a usable keyboard layout. This means, the caps lock key
has to instead send a ctrl.
</p>

<p>
Also I want the german and us layout switchable with win+space.
</p>
</div>

<div id="outline-container-org09d9837" class="outline-4">
<h4 id="org09d9837"><span class="section-number-4">2.1.1.</span> debian</h4>
<div class="outline-text-4" id="text-2-1-1">
<p>
<code>/etc/default/keyboard</code>
</p>

<div class="org-src-container">
<pre class="src src-bash">XKBMODEL="pc105"
XKBLAYOUT="de,us"
XKBVARIANT=""
XKBOPTIONS="ctrl:nocaps,grp:win_space_toggle,grp_led:scroll"

BACKSPACE="guess"
</pre>
</div>

<p>
<code>grp_led:scroll</code> makes a layout indicator out of the the scroll lock led.
</p>
</div>
</div>

<div id="outline-container-org9291db2" class="outline-4">
<h4 id="org9291db2"><span class="section-number-4">2.1.2.</span> other distros</h4>
<div class="outline-text-4" id="text-2-1-2">
<p>
see setxkbmap
</p>
<div class="org-src-container">
<pre class="src src-bash">setxkbmap -layout us,de -option win_space_toggle,grp_led:scroll -v
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org0a6aefc" class="outline-3">
<h3 id="org0a6aefc"><span class="section-number-3">2.2.</span> Keybindings/Prefix keys</h3>
<div class="outline-text-3" id="text-2-2">
<p>
I use a us keyboard layout, so <code>C-=</code> is nicely reachable and a
suitable prefix key.
</p>

<p>
On a terminal using putty, sadly, <code>C-=</code> doesn't work, so I use <code>&lt;f12&gt;</code>
instead. <code>&lt;f5&gt;</code> is free, too. <code>&lt;f9&gt;</code> I use for "compiling" or similar
stuff. (that was the binding in turbo-c and still seems to be used by
some IDEs).
</p>
</div>

<div id="outline-container-orga54f546" class="outline-4">
<h4 id="orga54f546"><span class="section-number-4">2.2.1.</span> Some of the bindings</h4>
<div class="outline-text-4" id="text-2-2-1">
<div class="org-src-container">
<pre class="src src-elisp">(global-set-key (kbd "C-= d") 'find-name-dired)
(global-set-key (kbd "C-= l") 'find-lisp-find-dired)
(global-set-key (kbd "C-= g") 'find-grep-dired)  ;;  or find-grep.

;; to complete filenames everywhere
(global-set-key (kbd "C-= TAB") 'term-dynamic-complete-filename)
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orga509a6c" class="outline-3">
<h3 id="orga509a6c"><span class="section-number-3">2.3.</span> recent-files</h3>
<div class="outline-text-3" id="text-2-3">
<div class="org-src-container">
<pre class="src src-elisp">;; recent files
(recentf-mode)

;; emacs loses the recent-files if terminal just dies
;; so regularly save recent-files
(run-with-idle-timer 300 t 'recentf-save-list)

(global-set-key (kbd "C-= f") 'recentf-open-files)
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf226f22" class="outline-3">
<h3 id="orgf226f22"><span class="section-number-3">2.4.</span> emacs server</h3>
<div class="outline-text-3" id="text-2-4">
<p>
start a server if there isn't already one running:
</p>
<div class="org-src-container">
<pre class="src src-elisp">(require 'server)
(unless (and (fboundp #'server-running-p) (server-running-p))
  (server-start))
</pre>
</div>
</div>

<div id="outline-container-org8a638de" class="outline-4">
<h4 id="org8a638de"><span class="section-number-4">2.4.1.</span> Troubleshooting</h4>
<div class="outline-text-4" id="text-2-4-1">
</div>
<ol class="org-ol">
<li><a id="orgcc5ad82"></a>emacsclient - socket<br />
<div class="outline-text-5" id="text-2-4-1-1">
<p>
You normally should not need this but if <code>emacsclient</code> doesn't find
the emacs server read this:
</p>

<p>
the server creates a unix domain socket. you can find out where by
<code>C-h v server-socket-dir</code>
</p>

<p>
sadly <code>emacsclient</code> doesn't use a config file to look up the
<code>server-socket-dir</code>, you can only specify it on the command line:
</p>

<div class="org-src-container">
<pre class="src src-bash">emacsclient --socket-name=/&lt;somedir&gt;/server &lt;file&gt;
</pre>
</div>

<p>
You can alias emacsclient with this socket name if it doesn't seem to
change.
</p>
</div>
</li>
</ol>
</div>
</div>

<div id="outline-container-org610107d" class="outline-3">
<h3 id="org610107d"><span class="section-number-3">2.5.</span> my multiple cursors shortcuts</h3>
<div class="outline-text-3" id="text-2-5">
<p>
I think MCs are cool but I don't use them much. I neither pretend
these are the best bindings nor do I claim completeness.
</p>

<p>
If you're in a terminal check what key is sent by the key
combination. I think it was <code>C-^</code> instead of <code>C-"</code>. Adjust
accordingly.
</p>

<div class="org-src-container">
<pre class="src src-elisp">;; multiple cursors
(global-set-key (kbd "C-\" a") 'mc/mark-all-like-this-dwim)
(global-set-key (kbd "C-\" l") 'mc/mark-next-lines)
(global-set-key (kbd "C-\" m") 'mc/mark-next-like-this)
(global-set-key (kbd "C-\" s") 'mc/mark-next-like-this-symbol)
(global-set-key (kbd "C-\" w") 'mc/mark-next-like-this-word)
(global-set-key (kbd "C-\" r") 'mc/mark-all-in-region)
(global-set-key (kbd "C-\" R") 'mc/mark-all-in-region-regexp)
</pre>
</div>
</div>
</div>

<div id="outline-container-orgd2aeafd" class="outline-3">
<h3 id="orgd2aeafd"><span class="section-number-3">2.6.</span> flymake</h3>
<div class="outline-text-3" id="text-2-6">
</div>
<div id="outline-container-org285854e" class="outline-4">
<h4 id="org285854e"><span class="section-number-4">2.6.1.</span> json (new version)</h4>
<div class="outline-text-4" id="text-2-6-1">
<p>
see: <a href="https://github.com/mokrates/json-simple-flymake">https://github.com/mokrates/json-simple-flymake</a>
</p>
</div>
</div>
<div id="outline-container-org93a1736" class="outline-4">
<h4 id="org93a1736"><span class="section-number-4">2.6.2.</span> toml</h4>
<div class="outline-text-4" id="text-2-6-2">
<div class="org-src-container">
<pre class="src src-elisp">(load "~/.emacs.d/tomlcheck.el")
(add-hook 'conf-toml-mode-hook 'flymake-tomlcheck-setup)
(add-hook 'conf-toml-mode-hook 'flymake-mode)
(add-hook 'conf-toml-mode-hook 'trailing-whitespace-mode)

;; if you want to add this automatically to .conf.j2 files
(add-to-list 'auto-mode-alist '("\\.conf\\.j2\\'" . conf-toml-mode))
</pre>
</div>
</div>

<ol class="org-ol">
<li><a id="orgd8f366f"></a><code>tomlcheck.el</code><br />
<div class="outline-text-5" id="text-2-6-2-1">
<div class="org-src-container">
<pre class="src src-elisp">;;; flymake-tomlcheck.el --- TOML linter with tomlcheck  -*- lexical-binding: t; -*-

;; replace /PATH/TO/TOMLCHECK.PY with actual path to tomlcheck.py
;; the contents should be:

;;;;;;;;;;;; tomlcheck.py
;; #!/usr/bin/env python3
;; # usage: python3 tomlcheck.py &lt; something.toml
;; # pip3 install --user toml

;; # emacs regex:  "^\\(?3:[^(]*\\)(line \\(?1:[0-9]+\\) column \\(?2:[0-9]+\\) char [0-9]+)$"
;; # (match-string 1) = line, (match-string 2) = col, (match-string 3) = msg

;; import sys
;; import toml

;; try:
;;     toml.load(sys.stdin)
;; except Exception as e:
;;     print(e)
;;;;;;;;;;;;;;;;;;

(require 'flymake)

(defgroup flymake-tomlcheck nil
  "Tomlcheck backend for Flymake."
  :prefix "flymake-tomlcheck-"
  :group 'tools)

(defcustom flymake-tomlcheck-arguments
  nil
  "A list of strings to pass to the tomlcheck program as arguments."
  :type '(repeat (string :tag "Argument")))

(defvar-local flymake-tomlcheck--proc nil)

(defun flymake-tomlcheck (report-fn &amp;rest _args)
  "Flymake backend for tomlcheck report using REPORT-FN."
  (when (process-live-p flymake-tomlcheck--proc)
    (kill-process flymake-tomlcheck--proc)
    (setq flymake-tomlcheck--proc nil))
  (let ((source (current-buffer)))
    (save-restriction
      (widen)
      (setq
       flymake-tomlcheck--proc
       (make-process
        :name "flymake-tomlcheck" :noquery t :connection-type 'pipe
        :buffer (generate-new-buffer " *flymake-tomlcheck*")
        :command `("/usr/bin/python" "/PATH/TO/TOMLCHECK.PY")
        :sentinel
        (lambda (proc _event)
          (when (eq 'exit (process-status proc))
            (unwind-protect
                (if (with-current-buffer source (eq proc flymake-tomlcheck--proc))
                    (with-current-buffer (process-buffer proc)
                      (goto-char (point-min))
                      (let ((diags))
                        (while (search-forward-regexp "^\\(?3:[^(]*\\)(line \\(?1:[0-9]+\\) column \\(?2:[0-9]+\\) char [0-9]+)$" nil t)
                          (let ((region (flymake-diag-region source (string-to-number (match-string 1)) (string-to-number (match-string 2))))
                                (error-type (match-string 3)))
                            ;; expect `region' to only have 2 values (start . end)
                            (when (and (car region) (cdr region))
                              (push (flymake-make-diagnostic source
                                                             (car region)
                                                             (cdr region)
                                                             :error
                                                             (match-string 3))
                                    diags))))
                        (funcall report-fn (reverse diags))))
                  (flymake-log :warning "Canceling obsolete check %s"
                               proc))
              (kill-buffer (process-buffer proc)))))))
      (process-send-region flymake-tomlcheck--proc (point-min) (point-max))
      (process-send-eof flymake-tomlcheck--proc))))

;;;###autoload
(defun flymake-tomlcheck-setup ()
  "Enable tomlcheck flymake backend."
  (make-variable-buffer-local 'flymake-diagnostic-functions)
  (add-hook 'flymake-diagnostic-functions #'flymake-tomlcheck nil t))

(provide 'flymake-tomlcheck)
;;; flymake-tomlcheck.el ends here
</pre>
</div>
</div>
</li>
</ol>
</div>

<div id="outline-container-org8d00306" class="outline-4">
<h4 id="org8d00306"><span class="section-number-4">2.6.3.</span> yaml</h4>
<div class="outline-text-4" id="text-2-6-3">
<div class="org-src-container">
<pre class="src src-elisp">(load "~/.emacs.d/flymake-yamllint.el")
(add-hook 'yaml-mode-hook 'flymake-yamllint-setup)
(add-hook 'yaml-mode-hook 'flymake-mode)
(add-hook 'yaml-mode-hook 'trailing-whitespace-mode)
</pre>
</div>

<p>
<a href="https://github.com/shaohme/flymake-yamllint">https://github.com/shaohme/flymake-yamllint</a>
</p>
</div>
</div>

<div id="outline-container-org4b34e76" class="outline-4">
<h4 id="org4b34e76"><span class="section-number-4">2.6.4.</span> python</h4>
<div class="outline-text-4" id="text-2-6-4">
<p>
see <a href="https://github.com/mokrates/flymaker">https://github.com/mokrates/flymaker</a>
</p>
</div>
</div>
</div>

<div id="outline-container-org6cb0b8a" class="outline-3">
<h3 id="org6cb0b8a"><span class="section-number-3">2.7.</span> ide stuff, languages</h3>
<div class="outline-text-3" id="text-2-7">
<p>
For flymaker, see <a href="#orgd2aeafd">2.6</a>
</p>
</div>
<div id="outline-container-orgf416613" class="outline-4">
<h4 id="orgf416613"><span class="section-number-4">2.7.1.</span> python</h4>
<div class="outline-text-4" id="text-2-7-1">
<div class="org-src-container">
<pre class="src src-elisp">;;;;;;;; python
(require 'auto-complete)
(require 'jedi)
;; these seem to be neccessary because of GUI/CUI, idk.
(define-key jedi-mode-map (kbd "C-c &lt;tab&gt;") 'jedi:complete)
(define-key jedi-mode-map (kbd "C-c TAB") 'jedi:complete)
(add-hook 'python-mode-hook 'jedi:setup)
(add-hook 'python-mode-hook (lambda () (interactive) (setq header-line-format "C-c TAB:complete | M-\":describe function | C-c ?:python doc")))

;; don't show this when idle. Don't do anything if I don't ask you!
;; M-" to show info. (how it is shown: defined in customize)
;; this is a monkey patch. may break with a new emacs version (currently working: 28.2)
(defun jedi:get-in-function-call-when-idle () ())
(define-key jedi-mode-map (kbd "M-\"") 'jedi:get-in-function-call)
</pre>
</div>
</div>
</div>

<div id="outline-container-org4a41c47" class="outline-4">
<h4 id="org4a41c47"><span class="section-number-4">2.7.2.</span> Golang</h4>
<div class="outline-text-4" id="text-2-7-2">
<div class="org-src-container">
<pre class="src src-elisp">;; golang
(add-hook 'go-mode-hook #'eglot-ensure)
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org69954ab" class="outline-3">
<h3 id="org69954ab"><span class="section-number-3">2.8.</span> show git branch in modeline</h3>
<div class="outline-text-3" id="text-2-8">
<div class="org-src-container">
<pre class="src src-elisp">(defun mo-term-git-mode--get-branch ()
  ;;(vc-call-backend 'git 'mode-line-string ".") ; doesn't work
  ;;(let ((branches (vc-git-branches)))
  (let ((branches (vc-call-backend 'git 'branches)))
    (when branches (car branches))))

(define-minor-mode mo-term-git-mode
  "show current branch in modeline in terminal-modes"
  :lighter (:eval (let ((git-branch (mo-term-git-mode--get-branch)))
                    (if git-branch
                        (format " git:%s" git-branch)
                      ""))))

(add-hook 'term-mode-hook 'mo-term-git-mode)
</pre>
</div>
</div>
</div>

<div id="outline-container-orga6cf925" class="outline-3">
<h3 id="orga6cf925"><span class="section-number-3">2.9.</span> <span class="todo TODO">TODO</span> ement.el (matrix client)</h3>
</div>

<div id="outline-container-orgfe281f5" class="outline-3">
<h3 id="orgfe281f5"><span class="section-number-3">2.10.</span> Random stuff</h3>
<div class="outline-text-3" id="text-2-10">
</div>
<div id="outline-container-org0f2f4cd" class="outline-4">
<h4 id="org0f2f4cd"><span class="section-number-4">2.10.1.</span> <code>align-regexp</code> shouldn't use tabs</h4>
<div class="outline-text-4" id="text-2-10-1">
<div class="org-src-container">
<pre class="src src-elisp">;; stolen from https://stackoverflow.com/questions/22710040/emacs-align-regexp-with-spaces-instead-of-tabs
(defadvice align-regexp (around align-regexp-with-spaces activate)
  (let ((indent-tabs-mode nil))
    ad-do-it))
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgbaa07bf" class="outline-3">
<h3 id="orgbaa07bf"><span class="section-number-3">2.11.</span> misc troubleshooting</h3>
<div class="outline-text-3" id="text-2-11">
</div>
<ol class="org-ol">
<li><a id="orgafa8dcb"></a>hanging xterm paste (also in putty)<br />
<div class="outline-text-5" id="text-2-11-0-1">
<div class="org-src-container">
<pre class="src src-elisp">;; in 27.2 ansi-term and some modification of xterm-paste don't work together so good
;; (results in a hang which you can only get out of by ^G
;; this solves it
(require 'term) ;; so this gets not overwritten the wrong way round
(defun term--xterm-paste (ev)
  "Insert the text pasted in an XTerm bracketed paste operation."
  (interactive "e")
  (term-send-raw-string (cadr ev)))
</pre>
</div>
</div>
</li>
</ol>
</div>
</div>


<div id="outline-container-org2454d10" class="outline-2">
<h2 id="org2454d10"><span class="section-number-2">3.</span> HOWTOs</h2>
<div class="outline-text-2" id="text-3">
</div>

<div id="outline-container-org7e4f8be" class="outline-3">
<h3 id="org7e4f8be"><span class="section-number-3">3.1.</span> Fonts</h3>
<div class="outline-text-3" id="text-3-1">
</div>
<div id="outline-container-orgd5c9ba2" class="outline-4">
<h4 id="orgd5c9ba2"><span class="section-number-4">3.1.1.</span> default font</h4>
<div class="outline-text-4" id="text-3-1-1">
<p>
<a href="https://www.gnu.org/software/emacs/manual/html_mono/emacs.html#fonts">emacs::fonts</a>
</p>

<p>
From the emacs docs:
</p>
<blockquote>
<p>
Add a line to your init file, modifying the variable
`default-frame-alist' to specify the `font' parameter (*note Frame Parameters::), like this:
</p>

<p>
(add-to-list 'default-frame-alist
  '(font . "DejaVu Sans Mono-10"))
</p>
</blockquote>
</div>
</div>


<div id="outline-container-org8889f35" class="outline-4">
<h4 id="org8889f35"><span class="section-number-4">3.1.2.</span> how to let emacs find a font for you</h4>
<div class="outline-text-4" id="text-3-1-2">
<p>
<code>customize-face</code> expects from you that you know the name and all
parameters of a font. When I wasn't using GTK I found this hard. I
found this way:
</p>

<p>
Use <code>describe-font</code> which give you an auto-complete in the minibuffer
which let's you look for and complete your font name. Kill the
complete font name.
</p>

<p>
Use <code>set-face-font</code> to set the font for the face you want to change.
</p>

<p>
After this, use <code>customize-font</code> to open a customize buffer which is
prefilled with the font you set with <code>set-face-font</code> and allows you to
save to your <code>~/.emacs</code>.
</p>
</div>
</div>

<div id="outline-container-org6d14a03" class="outline-4">
<h4 id="org6d14a03"><span class="section-number-4">3.1.3.</span> troubleshooting</h4>
<div class="outline-text-4" id="text-3-1-3">
<p>
Sometimes emacs loses the fonts you define. That seems to happen with
incompatible themes which redefine them. deinstall those themes and redefine your fonts.
</p>

<p>
Sometimes there seems to be a face lookup which results in a hangup
and the message that the face "undefined" can't be found. This usually
can't be fixed with a restart. This, too, was caused by a faulty
theme. Grep your <code>~/.emacs</code> for <code>undefined</code>, remove that particular
piece of configuration, remove the fauly theme and restart your emacs.
</p>
</div>
</div>
</div>

<div id="outline-container-org2d7a949" class="outline-3">
<h3 id="org2d7a949"><span class="section-number-3">3.2.</span> How to build an input method</h3>
<div class="outline-text-3" id="text-3-2">
<p>
I built one. See here: <a href="https://github.com/mokrates/quail-classic-german">quail classic german</a>
</p>
</div>
</div>

<div id="outline-container-orge124e02" class="outline-3">
<h3 id="orge124e02"><span class="section-number-3">3.3.</span> Tramp-Methods</h3>
<div class="outline-text-3" id="text-3-3">
<p>
I needed my own tramp method to change to another user.  The exact
sudo line I have to use is defined in <code>/etc/sudoers</code>.  So emacs can't
just decide by itself in the sudo method how this line might look.
</p>

<p>
This worked for me:
</p>

<div class="org-src-container">
<pre class="src src-elisp">(require 'tramp)
;;; my own tramp method!?

;;; for tmacswrap!
;;; tab-completion doesn't work, and results in hang.
;;; don't leave anything and use this syntax:
;;; /ssh:%h|MYMETHOD:USER@HOST:PATH
;;; see: /usr/share/emacs/27.2/lisp/net/tramp-sh.el.gz

(add-to-list 'tramp-methods '("MYUSER1"                                        ;;; name of the new method
                              (tramp-login-program "sudo")                     ;; the user changing command
                              (tramp-login-args (("/bin/su" "-" "myuser1")))   ;; the user changing line arguments
                              (tramp-remote-shell "/bin/sh")
                              (tramp-remote-shell-login ("-l"))
                              (tramp-remote-shell-args ("-c"))
                              (tramp-connection-timeout 10)
                              (tramp-session-timeout 300)))

(add-to-list 'tramp-methods '("MYUSER2"                          ;; name of the new method
                              (tramp-login-program "sudo")       ;; the user changing command
                              (tramp-login-args (("/bin/su" "-" "myuser2" "-s" "/bin/bash")))  ;; the user changing line arguments
                              (tramp-remote-shell "/bin/sh")
                              (tramp-remote-shell-login ("-l"))
                              (tramp-remote-shell-args ("-c"))
                              (tramp-connection-timeout 10)
                              (tramp-session-timeout 300)))

;;; it seems this should be set or tramp just randomly hangs
(add-to-list 'tramp-default-user-alist
             `(,(concat "\\`" (regexp-opt '("MYUSER1" "MYUSER2")) "\\'")  ;; name the methods
               nil "ignoredusername"))   ;; The above examples have the user hardcoded into them
</pre>
</div>
</div>
</div>

<div id="outline-container-org6d04833" class="outline-3">
<h3 id="org6d04833"><span class="section-number-3">3.4.</span> Ansi-Term</h3>
<div class="outline-text-3" id="text-3-4">
</div>
<div id="outline-container-org32ba702" class="outline-4">
<h4 id="org32ba702"><span class="section-number-4">3.4.1.</span> pasting</h4>
<div class="outline-text-4" id="text-3-4-1">
<p>
There is a function called <code>term-paste</code>, but it is bound to <code>S-insert</code>
by default. Who wants that? Use
</p>

<div class="org-src-container">
<pre class="src src-elisp">(require 'term)
(define-key term-raw-map (kbd "C-c y") 'term-paste)
(define-key term-raw-map (kbd "C-c C-y") 'term-paste)
</pre>
</div>

<p>
to rebind it to <code>C-c C-y</code>
</p>
</div>
</div>

<div id="outline-container-org0913787" class="outline-4">
<h4 id="org0913787"><span class="section-number-4">3.4.2.</span> tmacs</h4>
<div class="outline-text-4" id="text-3-4-2">
<p>
To conveniently open files from terminal even on remote machines, I
use <a href="https://github.com/mokrates/tmacs">tmacswrap</a>
</p>

<p>
You can define a function to quickly open a tmacs-term with
</p>

<div class="org-src-container">
<pre class="src src-elisp">(defun tmacs--find-free-number ()
  "use this function to create a reasonable buffer name"
  (cl-do ((num 0 (+ 1 num)))
      ((not (get-buffer (format "*tmacs&lt;%s&gt;*" num)))
       num)))

(defun tmacs ()
  (interactive)
  (ansi-term "/bin/bash" (format "tmacs&lt;%s&gt;" (tmacs--find-free-number))))
</pre>
</div>

<p>
and then open it with <code>M-x tmacs</code>.
</p>
</div>
</div>

<div id="outline-container-org96297cb" class="outline-4">
<h4 id="org96297cb"><span class="section-number-4">3.4.3.</span> emacsclient</h4>
<div class="outline-text-4" id="text-3-4-3">
<p>
Add to your <code>~/.bashrc</code>:
</p>
<div class="org-src-container">
<pre class="src src-bash">if [ -n "$INSIDE_EMACS" ]; then
    export VISUAL=emacsclient   # use tmacs here, if you want
    export EDITOR=$VISUAL
fi  
</pre>
</div>

<p>
Don't use <code>emacsclient -n</code> because that would confuse programs like
<code>git</code> when you edit your commit messages with this.
</p>
</div>
</div>

<div id="outline-container-org77110ef" class="outline-4">
<h4 id="org77110ef"><span class="section-number-4">3.4.4.</span> Forbid TRAMP to ask for password</h4>
<div class="outline-text-4" id="text-3-4-4">
<p>
It may be a problem if one mistypes on a password prompt in tramp,
because emacs might lock up your account if there is a limit of
unsuccessful logins.
</p>

<ul class="org-ul">
<li>tell ssh to not ask for password</li>
<li>override tramp function to ask for password and error out.</li>
</ul>

<div class="org-src-container">
<pre class="src src-elisp">;; ~/.emacs

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; tramp
(setq tramp-ssh-controlmaster-options "-o PasswordAuthentication=no")

;; don't ever ask for passwords!
;; TODO: implement as advice
(defun tramp-read-passwd (proc &amp;optional prompt)
  (message "Tramp tries to ask for password, inhibiting")
  (error "Tramp tried to ask for password")) ;; just fail

</pre>
</div>

<p>
To allow emacs to TRAMP somewhere, nonetheless, use a controlmaster
connection
</p>

<pre class="example" id="orge0dcf67">
# ~/.ssh/config

# use this, if you have a domain. Else something might not work when using shortnames 
# CanonicalizeHostname yes
# CanonicalDomains my.domain.com

host *
    ControlMaster auto
    ControlPath ~/.ssh/control/%C
    ControlPersist 15m
</pre>
</div>
</div>


<div id="outline-container-org731fe56" class="outline-4">
<h4 id="org731fe56"><span class="section-number-4">3.4.5.</span> troubleshooting</h4>
<div class="outline-text-4" id="text-3-4-5">
</div>
<ol class="org-ol">
<li><a id="org03ec20e"></a>slow scrolling (emacs 26.1 has this problem)<br />
<div class="outline-text-5" id="text-3-4-5-1">
<p>
In older emacs versions ansi-term was allegedly very slow clearing the
screen. In version 26.1 the problem seems to be fixed, but still
triggered in a different way: Scrolling fast, if the terminal buffer
is already full. I solved this problem by using this<sup><a id="fnr.1" class="footref" href="#fn.1" role="doc-backlink">1</a></sup>
</p>

<div class="org-src-container">
<pre class="src src-elisp">;; Terminal buffer configuration.
(add-hook 'term-mode-hook 'my-term-mode-hook)
(defun my-term-mode-hook ()
  ;; https://debbugs.gnu.org/cgi/bugreport.cgi?bug=20611
  (setq bidi-paragraph-direction 'left-to-right))  
</pre>
</div>
</div>
</li>

<li><a id="org19dfd0c"></a>terminal resizing (emacs 26.1 has this problem)<br />
<div class="outline-text-5" id="text-3-4-5-2">
<p>
Resizing the terminal in which emacs runs doesn't inform inferior
terminals that they should be resized, too. Use this<sup><a id="fnr.2" class="footref" href="#fn.2" role="doc-backlink">2</a></sup>:
</p>

<div class="org-src-container">
<pre class="src src-elisp">(add-hook 'window-configuration-change-hook (lambda (frame) (window--adjust-process-windows)))
</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<div id="footnotes">
<h2 class="footnotes">Footnotes: </h2>
<div id="text-footnotes">

<div class="footdef"><sup><a id="fn.1" class="footnum" href="#fnr.1" role="doc-backlink">1</a></sup> <div class="footpara" role="doc-footnote"><p class="footpara">
<a href="https://www.emacswiki.org/emacs/AnsiTermHints#h5o-8">https://www.emacswiki.org/emacs/AnsiTermHints#h5o-8</a>
</p></div></div>

<div class="footdef"><sup><a id="fn.2" class="footnum" href="#fnr.2" role="doc-backlink">2</a></sup> <div class="footpara" role="doc-footnote"><p class="footpara">
<a href="https://gnu.emacs.bug.narkive.com/nNqAqMND/bug-43126-26-1-ansi-term-not-resized-after-x-window-resize">https://gnu.emacs.bug.narkive.com/nNqAqMND/bug-43126-26-1-ansi-term-not-resized-after-x-window-resize</a>
</p></div></div>


</div>
</div></div>
<div id="postamble" class="status">
<p class="author">Author: mokrates</p>
<p class="date">Created: 2026-02-21 Sa 21:11</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
